{% extends 'events/base.html' %}

{% block title %}{{ event.title }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'index' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="breadcrumb-item active">{{ event.title }}</li>
            </ol>
        </nav>
        
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <div class="d-flex justify-content-between align-items-center">
                    <h4 class="mb-0">{{ event.title }}</h4>
                    <span class="badge bg-light text-dark">
                        {{ event.get_category_display }}
                    </span>
                </div>
            </div>
            
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <p><strong>üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</strong><br>
                        {{ event.date|date:"d.m.Y H:i" }}</p>
                        
                        <p><strong>üìç –ú–µ—Å—Ç–æ:</strong><br>
                        {{ event.location }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>üë§ –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä:</strong><br>
                        –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–∞–π—Ç–∞</p>
                        
                        <p><strong>üìÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ:</strong><br>
                        {{ event.created_at|date:"d.m.Y" }}</p>
                    </div>
                </div>
                
                <h5>–û–ø–∏—Å–∞–Ω–∏–µ</h5>
                <p class="card-text">{{ event.description }}</p>
                
                <hr>
                
                <div class="mb-4">
                    <h5>–ö—Ç–æ –∏–¥–µ—Ç? ({{ event.participation_set.count }})</h5>
                    <form method="post" action="{% url 'participate' event.id %}" class="mb-3">
                        {% csrf_token %}
                        <div class="input-group">
                            <input type="text" class="form-control" name="user_name"
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required>
                            <button class="btn btn-go" type="submit">
                                üëç –Ø –ø–æ–π–¥—É!
                            </button>
                        </div>
                    </form>
                    
                    {% if event.participation_set.all %}
                        <div class="d-flex flex-wrap gap-2">
                            {% for participation in event.participation_set.all %}
                            <span class="badge bg-success">
                                {{ participation.user_name }}
                            </span>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted">–ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –∑–∞–ø–∏—Å–∞–ª—Å—è. –ë—É–¥—å –ø–µ—Ä–≤—ã–º!</p>
                    {% endif %}
                </div>
                
                <hr>
                
                <div>
                    <h5>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ event.comment_set.count }})</h5>
                    <form method="post" action="{% url 'add_comment' event.id %}" class="mb-4">
                        {% csrf_token %}
                        <div class="mb-3">
                            <input type="text" class="form-control mb-2" name="author_name"
                                   placeholder="–í–∞—à–µ –∏–º—è" required>
                            <textarea class="form-control" name="text" rows="3"
                                      placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </form>
                    
                    {% for comment in event.comment_set.all %}
